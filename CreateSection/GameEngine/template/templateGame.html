<!--
trust me you're going to need it(ctrl + click): 
https://www.youtube.com/watch?v=fGKIm9mPY_w&ab_channel=RICHIEROZEX
or for chill
https://www.youtube.com/playlist?list=PLBkutC8eoG7ZEHRZN51RD4yPLgko9ucPl
or for feeling adventurous
https://www.youtube.com/playlist?list=PLBkutC8eoG7akBOVrohTvifuk1Ptg7oi-
or for feeling energetic
https://www.youtube.com/playlist?list=PLBkutC8eoG7ac2HEOAtkfPtTWy3Z5uGtD
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Game Name</title>
    </head>
    <body>
        <!--CSS goes here-->
        <style>
            body{
                font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                background: white;
                margin: 0;
                font-size: 15px;
                overflow: hidden;
            }
            /*left column*/
            #left{
                position: absolute;
                height: 100%;
                width: 20%;
            }
            #map{
                position: absolute;
                aspect-ratio: 1/1;
                max-width: 300px;
                max-height: 300px;
                width: 100%;
                background: rgb(210, 210, 210);
            }
            #hotbar{
                position: absolute;
                width: 100%;
                aspect-ratio: 1/1.5;
                max-height: 300px;
                max-width: 200px;
                text-align: center;
                bottom: 0;
                background: rgb(210, 210, 210);
            }
            #hbarEquipment{
                background-color: rgb(155, 155, 155);
                width: 100%;
                aspect-ratio: 1/0.75;
                text-align: left;
            }
            #hbarEquipment p{
                padding: 0;
                margin: 0;
                font-size: 13px;
                margin-top: 3px;
                padding-left: 5px;
            }
            #hbarEquipment h4{
                font-size: 17px;
                margin: 0;
                padding-bottom: 3px;
                text-align: center;
            }
            #inventoryButton{
                display: flex;
            }
            #inventoryButton p{
                margin: 1px;
                padding-left: 3px;
            }
            #inventoryButton button{
                background: rgb(155, 155, 155);
                text-align: center;
                aspect-ratio: 1.25/1;
                border: 0;
                transition-duration: 0.3s;
            }
            #inventoryButton:hover button{
                background: rgb(210, 210, 210);
            }
            #inventoryButton:hover{
                cursor: pointer;
            }
            #questsButton{
                display: flex;
            }
            #questsButton p{
                margin: 1px;
                padding-left: 3px;
            }
            #questsButton button{
                background: rgb(155, 155, 155);
                text-align: center;
                aspect-ratio: 1.25/1;
                border: 0;
                transition-duration: 0.3s;
            }
            #questsButton:hover button{
                background: rgb(210, 210, 210);
            }
            #questsButton:hover{
                cursor: pointer;
            }
            /*right column*/
            #right{
                position: absolute;
                background: rgb(85, 85, 85);
                left: 85%;
                height: 100%;
                width: 15%;
            }
            #settingsButton{
                background: rgb(155, 155, 155);
                display: flex;
                transition-duration: 0.3s;
            }
            #settingsButton p{
                margin: 1px;
                padding-left: 3px;
            }
            #settingsButton button{
                background: rgb(210, 210, 210);
                text-align: center;
                aspect-ratio: 1.25/1;
                border: 0;
            }
            #settingsButton:hover{
                background: rgb(210, 210, 210);
                cursor: pointer;
            }
            #saveButton{
                background: rgb(155, 155, 155);
                display: flex;
                transition-duration: 0.3s;
            }
            #saveButton p{
                margin: 1px;
                padding-left: 3px;
            }
            #saveButton button{
                background: rgb(210, 210, 210);
                text-align: center;
                aspect-ratio: 1.25/1;
                border: 0;
            }
            #saveButton:hover{
                background: rgb(210, 210, 210);
                cursor: pointer;
            }
            #dictionaryButton{
                background: rgb(155, 155, 155);
                display: flex;
                transition-duration: 0.3s;
            }
            #dictionaryButton p{
                margin: 1px;
                padding-left: 3px;
            }
            #dictionaryButton button{
                background: rgb(210, 210, 210);
                text-align: center;
                aspect-ratio: 1.25/1;
                border: 0;
            }
            #dictionaryButton:hover{
                background: rgb(210, 210, 210);
                cursor: pointer;
            }
            /*center column*/
            #center{
                font-size: 15px;
                margin-left: 20%;
                display: flex;
                position: absolute;
                align-content: center;
                height: 100%;
                width: 65%;
            }
            #output{
                width: 100%;
                height: calc(100% - 40px);
                overflow-y: scroll;
            }
            #playerOut{
                margin: 0;
                padding-left: 10px;
                padding-right: 10px;
                padding-top: 7px;
                padding-bottom: 7px;
                background: white;
            }
            #gameOut{
                margin: 0;
                padding: 0;
                padding-left: 10px;
                padding-right: 10px;
                padding-top: 7px;
                padding-bottom: 7px;
                background-color: rgb(155, 155, 155);
            }
            #inventory{
                margin: 0;
                padding: 0;
                padding-left: 15px;
                padding-right: 10px;
                padding-top: 7px;
                padding-bottom: 7px;
                font-size: 11px;
                background-color: rgb(155, 155, 155);
            }
            #input{
                display: flex;
                text-align: center;
                position: absolute;
                width: 100%;
                height: 40px;
                bottom: 0;
            }
            #textInput{
                background: rgb(210, 210, 210);
                font-size: 17px;
                width: 90%;
                margin: 0;
                border: 0;
                padding: 0;
            }
            #logInput{
                background: rgb(210, 210, 210);
                font-size: 15px;
                width: 100%;
                margin: 0;
                border: 0;
                padding: 0;
            }
            #send{
                background: rgb(155, 155, 155);
                width: 10%;
                border: 0;
                margin: 0;
                padding: 0;
                transition-duration: 0.3s;
            }
            #send:hover{
                background: rgb(210, 210, 210);
                cursor: pointer;
            }
        </style>
        <!--HTML goes here-->
        <!--HTML will not be editable by the user-->
        <section id="left">
            <canvas id="map"></canvas>
            <div id="hotbar">
                <p>Player Health = 10 ‚ô•Ô∏è</p>
                <div id="hbarEquipment">
                    <h4>Equiped Items:</h4>
                    <p id="head">Head: Helmet</p>
                    <p id="chest">Torso: Chestplate</p>
                    <p id="legs">Legs: Leg Things</p>
                    <p id="lHand">Left Hand: Shield</p>
                    <p id="rHand">Right Hand: Sword</p>
                    <p id="secondary">Secondary: Rabit's Foot</p>
                </div>
                <!--buttons also have to have a text input function, their functions can't only be accessed through the button, it has to be able to be accessed through text inputs like "settings" or "inventory", and there will be no more further GUI, even these buttons will only display text in the game log area-->
                <a id="inventoryButton">
                    <button>üíº</button>
                    <p>Inventory</p>
                </a>    
                <a id="questsButton">
                    <button>üó∫Ô∏è</button>
                    <p>Quests</p>
                </a>
            </div>
            <!--this is the left column, it will contain the map and some other things, towards the bottom of the column I should display important things like health, equiped items, and etc.-->
        </section>
        <section id="right">
            <!--display settings in the log-->
            <a id="settingsButton">
                <button>‚öôÔ∏è</button>
                <p>Settings</p>
            </a>
            <!--save game and display "game saved" in log-->
            <a id="saveButton">
                <button>üì•</button>
                <p>Save</p>
            </a>
            <!--display a dictionary of items and entities including stats in log-->
            <a id="dictionaryButton">
                <button>üìú</button>
                <p>Dictionary</p>
            </a>
            <!--this is the left column, I think that this side should be reserved for buttons to access settings (if i make that), and other menus or functions like saving-->
        </section>
        <section id="center">
            <!--make this scrollable so people can see what happened in the past of the game-->
            <div id="output">
                
            </div>
            <div id="input">
                <input id="textInput" type="text" placeholder=" enter commands here">
                <button id="send" onclick="runGame()">‚úî</button>
            </div>
        </section>
        <!--JS goes here-->
        <!--JS will not be editable by the user-->
        <script>
            //water mark not completed yet
            console.log('Made with {fill this in once you have info and names, add the name of the engine and the url}')
            //basic variables
            const gameLog = document.getElementById('output');
            //index 0 = x, index 1 = y
            var plyrPosition = [0, 0];
            var lastPosition = [0, 0];
            var logInputTxt = '';
            var plyrInput = '';
            var gameOutput = '';
            var instructions = '<h4>Movement:</h4><ul><li>up</li><li>down</li><li>left</li><li>right</li></ul><h4>Enviorment Interaction:</h4><ul><li>inspect</li><li>take</li></ul><h4>Commands:</h4><ul><li>help</li><li>inventory</li><li>quests</li><li>settings</li><li>save</li><li>cls</li></ul>';

            //quest variables
            const quests = ['quest 1', 'gay', 'quest 3'];
            var activeQuests = [];
            //add quests for testing, this should be part of game loop
            activeQuests.push(quests[0], quests[2], quests[1]);

            //item variables and inventory
            //need to add functionality of equipping items and removing them from the players inventory
            //name | use or equip | health effect | attack effect | where it is equiped
            const items = [['apples', 'use', 10, 0], ['banana', 'use', 5, 0], ['sword', 'equip', 0, 15], ['gold', 'none', 0, 0]];
            var inventory = [];
            var invList = [];
            var playerItems = [];
            var amountAlrIn = inventory.length;
            //0 = head | 1 = torso | 2 = legs | 3 = left hand | 4 = right hand | 5 = secondary
            var equiped = [];

            //entities
            const entities = [
                //name, held items(use 'items[index]'), quests(use 'quests[index]'), 
                ['Bob', items[3], quests[1]],
                ['Gary', items[2]]
            ];

            //map and room data
            var map = [
                //x, y | text, look around text, entities, items
                [[0, 0], ['this is a room 1', 'get out', [entities[1]], [items[2], items[0], items[3], items[3]]]],
                [[0, -2], ['banan']],
                [[1, -2], ['hall']],
                [[2, -2], ['side room bottom']],
                [[0, -1], ['hall']],
                [[1, 0], ['hall']],
                [[2, 0], ['side room middle']],
                //make it so that a hall automatically gets the description of 'hall', also don't allow multiple rooms next to eachother, they have to be seperated and then connected by a hall(also only allow halls to be placed in between two rooms, rooms are placed first then connected with halls)
                [[0, 1], ['hall']],
                [[0, 2], ['this is a room 2', 'you sense the aura of a gay man in the room', [entities[0]], [items[1], items[2], items[0], items[2]]]]
            ];
            var currRoomData = map[0][1];
            
            //give instructions on game open or on help command
            function help(){
                addLog(instructions, 'inventory', 0);
                addInput('logInput', 1);
            }

            //run game without pushing check button
            document.onkeydown = function(e){
                e = e || window.event;
                var key = e.which || e.keyCode;
                if(key === 13){
                    runGame();
                }
            }

            //tell the player the instructions
            addLog(instructions, 'inventory', 1);

            //main function that runs the game
            function runGame(){
                //reset player and game output and input
                plyrInput = '';
                gameOutput = '';

                //get input field text
                plyrInput = document.getElementById('textInput').value;
                plyrInput = plyrInput.trim();

                //check if there is input
                if(plyrInput != ''){
                    //remove log input after it has been used to prevent possible issues
                    if(document.getElementById('logInput') != null){
                        gameLog.removeChild(document.getElementById('logInput'));
                    }
                    //interpret player inputs
                    interpredator(plyrInput);
                    //add player input to the log
                    addLog(plyrInput, 'playerOut', 0);
                }
                else{
                    //interpret player inputs in the log input if it exists
                    logInterpredator();
                }

                //add game output to the log
                if(gameOutput != ''){
                    addLog(gameOutput, 'gameOut', 1);
                }
                
                //clear the input fields
                if(document.getElementById('logInput') != null){
                    document.getElementById('logInput').value = '';
                }
                document.getElementById('textInput').value = '';
            }

            //add something to the log (order is either 0 or 1)
            function addLog(text, id, order){
                var element = document.createElement('p');
                element.id = id;
                element.innerHTML = text;
                gameLog.insertBefore(element, gameLog.children[order]);
            }

            //adds an input box in the log so the menus can be interacted with
            function addInput(id, order){
                var element = document.createElement('input');
                element.type = 'text';
                element.placeholder = ' interect with the menu above here'
                element.id = id;
                gameLog.insertBefore(element, gameLog.children[order]);
            }

            //interprets the log input text
            function logInterpredator(){
                if(document.getElementById('logInput') == null){
                    return;
                }
                else{
                    //get input from log input field
                    logInputTxt = document.getElementById('logInput').value;
                    logInputTxt = logInputTxt.trim();
                    //if there is nothing in the box then do nothing
                    if(logInputTxt == ''){
                        return;
                    }
                    //if there is then do this
                    else{
                        //split the input into an array to make comparisons easy
                        logInputArray = logInputTxt.split(' ');
                        //make a copy the inventory that can be compared with playerItems
                        invCopyManager();
                        //check inputs
                        if(logInputArray[0] == 'use'){
                            useItem();
                        }
                        //else if(){
                            //this is only here to show what the other ones should look like
                        //}
                        else{
                            gameOutput = 'not recognized';
                        }
                    }
                }
            }

            //issue area, work on this
            //function called when you use an item
            function useItem(){
                for(let i = 0; i < inventory.length; i++){
                    if(logInputArray[1] == i){
                        console.log(inventory[i]);
                        gameOutput = 'you used: ' + invList[i];
                        for(let f = 0; f < playerItems.length; f++){
                            if(playerItems[f][0] == invList[i]){
                                console.log(f);
                                console.log(invList[i]);
                                console.log(playerItems[f][0]);
                                console.log('found and removing match');
                                console.log(playerItems);
                                playerItems = playerItems.splice(f, 1);
                                console.log(playerItems);
                                return;
                            }
                        }
                    }
                }
            }


            //keep away from children
            function interpredator(text){
                //movement
                if(text == 'up'){
                    plyrPosition[1] += 1;
                    accessMapInfo(plyrPosition);
                }
                else if(text == 'down'){
                    plyrPosition[1] -= 1;
                    accessMapInfo(plyrPosition);
                }
                else if(text == 'left'){
                    plyrPosition[0] += 1;
                    accessMapInfo(plyrPosition);
                }
                else if(text == 'right'){
                    plyrPosition[0] -= 1;
                    accessMapInfo(plyrPosition);
                }
                //enviorment interaction
                else if(text == 'inspect'){
                    gameOutput = currRoomData[1];
                }
                else if(text == 'take'){
                    accessItems();
                }
                //ui in text
                else if(text == 'help'){
                    help();
                }
                else if(text == 'settings'){
                    gameOutput = 'settings list';
                }
                else if(text == 'inventory'){
                    accessInventory();
                }
                else if(text == 'quests'){
                    gameOutput = activeQuests.toString().replaceAll(',', '<br>');
                }
                else if(text == 'save'){
                    //have to makegame saving thingy here
                    gameOutput = 'game saved';
                }
                else if(text == 'dictionary'){
                    gameOutput = 'dictionary of items and entities';
                }
                else if(text == 'cls'){
                    gameLog.innerHTML = '';
                    gameOutput = 'screen cleared'
                }
                else{
                    gameOutput = 'not recognized';
                }
            }

            //access the information stored in the map
            function accessMapInfo(plyrString){
                plyrString.toString();
                var positionTest = 0;
                for(let i = 0; i < map.length; i++){
                    var mapString = map[i][0].toString();
                    if(mapString == plyrString){
                        positionTest = 1;
                        if(map[i][1][0] == 'hall'){
                            velocityY = plyrString[1] - lastPosition[1];
                            velocityX = plyrString[0] - lastPosition[0];
                            plyrPosition[1] += velocityY;
                            plyrPosition[0] += velocityX;
                            for(let u = 0; u < map.length; u++){
                                if(map[u][0].toString() == plyrPosition.toString()){
                                    currRoomData = map[u][1];
                                }
                            }
                        }
                        else{
                            currRoomData = map[i][1];
                        }
                        gameOutput = currRoomData[0];
                        lastPosition = [...plyrPosition];
                        return;
                    }
                }
                if(positionTest != 1){
                    plyrPosition = [...lastPosition];
                    gameOutput = 'cant go there';
                }
            }

            //access items in the map
            function accessItems(){
                if(currRoomData[3] == 'Nothing'){
                    gameOutput = 'You took:<br>Nothing';
                    return;
                }
                playerItems = playerItems.concat(currRoomData[3]);
                inventory = [...playerItems];
                duplicateChecker(inventory);
                duplicateChecker(currRoomData[3]);
                for(let i = 0; i < currRoomData[3].length; i++){
                    currRoomData[3][i].splice(1);
                }
                for(let r = 0; r < inventory.length; r++){
                    inventory[r].splice(1);
                }
                gameOutput = 'You took: <br>' + currRoomData[3].toString().replaceAll(',', '<br>');
                currRoomData.splice(3, 1);
                currRoomData.push('Nothing');
                addIndex();
            }
            
            function addIndex(){
                //add index to items
                for(let i = amountAlrIn; i < inventory.length; i++){
                    inventory[i] = [i + ': ' + inventory[i]];
                }
            }

            //checks for duplicate items in an array
            function duplicateChecker(array){
                for(let i = 0; i < array.length; i++){
                    var duplicateCheck = array[i];
                    var itemCount = 0;
                    for(let c = 0; c < array.length; c++){
                        if(duplicateCheck == array[c]){
                            itemCount += 1;
                        }
                    }
                    if(itemCount > 1){
                        for(let d = 0; d < array.length; d++){
                            if(array[d] == duplicateCheck){
                                array.splice(d, 1);
                                d--;
                            }
                        }
                        var hold = itemCount + ' ' + duplicateCheck;
                        var pushing = hold.split(',');
                        array.push(pushing);
                    }
                }
            }

            //displays inventory and initiates input box for menu
            function accessInventory(){
                if(inventory.length != 0){
                    gameOutput = inventory.toString().replaceAll(',', '<br>');
                    addInput('logInput', 0);
                }
                else{
                    gameOutput = 'Inventory is empty';
                }
            }
            
            //creates a copy of inventory in the correct order without labels or number of items
            function invCopyManager(){
                invList = [...inventory];
                for(let i = 0; i < invList.length; i++){
                    invList[i] = invList[i][0].slice(2);
                    if(!isNaN(parseInt(invList[i][1]))){
                        invList[i] = invList[i].trim();
                        for(let e = 0; e < invList[i].length; e++){
                            if(!isNaN(parseInt(invList[i][e]))){
                                invList[i] = invList[i].slice(1);
                                invList[i] = invList[i].trim();
                                e--;
                            }
                        }
                    }
                    else{
                        invList[i] = invList[i].trim();
                    }
                }
            }
        </script>
    </body>
</html>